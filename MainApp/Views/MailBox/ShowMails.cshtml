
@using JanuszMail.Models;
@model PagedList.Core.IPagedList<Mail>
<Cache vary-by-query="page,pageSize,sortOrder,folder" vary-by-user="true">
    <h3>@ViewBag.Folder</h3>
    <table class="table table-striped table-hover panel panel-default">
        <tr class="row">
            <th class="col-md-1 col-sm-1 col-lg-1">
            </th>
            <th class="col-md-7 col-sm-7 col-lg-7">
                 <a class="btn-block" asp-area="" asp-controller="Mailbox" asp-action="ShowMails"
                    asp-route-page="@Model.PageNumber"
                    asp-route-pageSize="@Model.PageSize"
                    asp-route-folder="@ViewBag.Folder"
                    asp-route-sortOrder="@ViewBag.SubjectSortParam"
                    >
                    @Html.DisplayNameFor(model => model[0].Subject)
                </a>
            </th>
            <th class="col-md-2 col-sm-2 col-lg-2">
                 <a class="btn-block" asp-area="" asp-controller="Mailbox" asp-action="ShowMails"
                    asp-route-page="@Model.PageNumber"
                    asp-route-pageSize="@Model.PageSize"
                    asp-route-folder="@ViewBag.Folder"
                    asp-route-sortOrder="@ViewBag.SenderSortParam"
                    >
                    Sender
                </a>
            </th>
            <th class="col-md-2 col-sm-2 col-lg-2">
                 <a class="btn-block" asp-area="" asp-controller="Mailbox" asp-action="ShowMails"
                    asp-route-page="@Model.PageNumber"
                    asp-route-pageSize="@Model.PageSize"
                    asp-route-folder="@ViewBag.Folder"
                    asp-route-sortOrder="@ViewBag.DateSortParam"
                    >
                    @Html.DisplayNameFor(model => model[0].Date.Date)
                </a>
            </th>
        </tr>
@foreach (var item in Model) {
        <tr class="row">
            <td>
                <form asp-controller="MailBox" method="post">
                    <input type="hidden" name="id" value="@item.ID.Id"/>
                    <input type="hidden" name="folder" value="@ViewData["Folder"]"/>
                    <input type="hidden" name="returnUrlPassing" value="@ViewData["ReturnUrl"]"/>
                    <input type="hidden" name="returnUrlFailing" value="@ViewData["ReturnUrl"]"/>
                    <div class="btn-group">
                    <button class="btn-danger btn" type="submit" formaction="Delete">
                        <span class="fa fa-trash"></span>
                    </button>
                    @{
                        var envelopeClass = item.IsRead == true ? "fa-envelope-open" : "fa-envelope";
                        var markAction = item.IsRead == true ? "MarkUnread" : "MarkRead";
                        var buttonClass = item.IsRead == true ? "btn-info" : "btn-warning";
                    }
                    <button class="btn @buttonClass" type="submit" formaction="@markAction">
                        <span class="fa @envelopeClass"></span>
                    </button>
                    </div>
                </form>
            </td>
            <td>
                 <a class="btn-block" asp-area="" asp-controller="Mailbox" asp-action="Details" asp-route-id="@item.ID.Id" asp-route-folder="@ViewData["Folder"]">
                @Html.DisplayFor(modelItem => item.Subject)
                    </a>
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.SenderName)
                @Html.DisplayFor(modelItem => item.SenderEmail)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Date)
            </td>
        </tr>
}
     </table>
    Generated at: @DateTime.Now
</Cache>

@Html.Partial("_Pager")
